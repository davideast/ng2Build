{"version":3,"file":"/Users/deast/Angular/angular/modules/change_detection/src/change_detector.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/18","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/20","change_detector.js","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/0"],"names":[],"mappings":"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","sourceRoot":"/Users/deast/Angular/angular/modules/change_detection/src/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","\n          var $__exportNames = $__placeholder__0;\n        ","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","\n          Object.keys(m).forEach(function(p) {\n            if (!$__exportNames[p])\n              $__export(p, m[p]);\n          });\n        ","$__placeholder__0 = $__placeholder__1","function($__super) {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4, $__super);\n        }($__placeholder__5)","import {ProtoRecordRange, RecordRange} from './record_range';\nimport {ProtoRecord, Record} from './record';\nimport {int, isPresent, isBlank} from 'facade/lang';\nimport {ListWrapper, List} from 'facade/collection';\n\nexport * from './record';\nexport * from './record_range'\n\nclass ExpressionChangedAfterItHasBeenChecked extends Error {\n  message:string;\n\n  constructor(record:Record) {\n    this.message = `Expression '${record.expressionAsString()}' has changed after it was checked. ` +\n      `Previous value: '${record.previousValue}'. Current value: '${record.currentValue}'`;\n  }\n\n  toString():string {\n    return this.message;\n  }\n}\n\nexport class ChangeDetector {\n  _rootRecordRange:RecordRange;\n  _enforceNoNewChanges:boolean;\n\n  constructor(recordRange:RecordRange, enforceNoNewChanges:boolean = false) {\n    this._rootRecordRange = recordRange;\n    this._enforceNoNewChanges = enforceNoNewChanges;\n  }\n\n  detectChanges():int {\n    var count = this._detectChanges(false);\n    if (this._enforceNoNewChanges) {\n      this._detectChanges(true)\n    }\n    return count;\n  }\n\n  _detectChanges(throwOnChange:boolean):int {\n    var count = 0;\n    var updatedRecords = null;\n    var record = this._rootRecordRange.findFirstEnabledRecord();\n    var currentRange, currentGroup;\n\n    while (isPresent(record)) {\n      if (record.check()) {\n        count++;\n        if (record.terminatesExpression()) {\n          if (throwOnChange) throw new ExpressionChangedAfterItHasBeenChecked(record);\n          currentRange = record.recordRange;\n          currentGroup = record.groupMemento();\n          updatedRecords = this._addRecord(updatedRecords, record);\n        }\n      }\n\n      if (isPresent(updatedRecords)) {\n        var nextEnabled = record.nextEnabled;\n        if (isBlank(nextEnabled) ||                       // we have reached the last enabled record\n            currentRange !== nextEnabled.recordRange ||    // the next record is in a different range\n            currentGroup !== nextEnabled.groupMemento()) { // the next record is in a different group\n          currentRange.dispatcher.onRecordChange(currentGroup, updatedRecords);\n          updatedRecords = null;\n        }\n      }\n\n      record = record.findNextEnabled();\n    }\n\n    return count;\n  }\n\n  _addRecord(updatedRecords:List, record:Record) {\n    if (isBlank(updatedRecords)) {\n      updatedRecords = _singleElementList;\n      updatedRecords[0] = record;\n\n    } else if (updatedRecords === _singleElementList) {\n      updatedRecords = [_singleElementList[0], record];\n\n    } else {\n      ListWrapper.push(updatedRecords, record);\n    }\n    return updatedRecords;\n  }\n}\n\nvar _singleElementList = [null];\n","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});","var $__placeholder__0 = $__export($__placeholder__1, $__placeholder__2);","function() {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4);\n        }()","$traceurRuntime.type.$__placeholder__0)"]}