{"version":3,"file":"/Users/deast/Angular/angular/modules/core/src/compiler/compiler.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/14","compiler.js","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourceRoot":"/Users/deast/Angular/angular/modules/core/src/compiler/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","var $__placeholder__0 = $__export($__placeholder__1, $__placeholder__2);","function() {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4);\n        }()","import {Type, FIELD, isBlank, isPresent, BaseException, stringify} from 'facade/lang';\nimport {Promise, PromiseWrapper} from 'facade/async';\nimport {List, ListWrapper, MapWrapper} from 'facade/collection';\nimport {DOM, Element} from 'facade/dom';\n\nimport {Parser} from 'change_detection/change_detection';\n\nimport {DirectiveMetadataReader} from './directive_metadata_reader';\nimport {ProtoView} from './view';\nimport {CompilePipeline} from './pipeline/compile_pipeline';\nimport {CompileElement} from './pipeline/compile_element';\nimport {createDefaultSteps} from './pipeline/default_steps';\nimport {TemplateLoader} from './template_loader';\nimport {DirectiveMetadata} from './directive_metadata';\nimport {Component} from '../annotations/annotations';\nimport {Content} from './shadow_dom_emulation/content_tag';\n\n/**\n * Cache that stores the ProtoView of the template of a component.\n * Used to prevent duplicate work and resolve cyclic dependencies.\n */\nexport class CompilerCache {\n  _cache:Map;\n  constructor() {\n    this._cache = MapWrapper.create();\n  }\n\n  set(component:Type, protoView:ProtoView) {\n    MapWrapper.set(this._cache, component, protoView);\n  }\n\n  get(component:Type):ProtoView {\n    var result = MapWrapper.get(this._cache, component);\n    if (isBlank(result)) {\n      // need to normalize undefined to null so that type checking passes :-(\n      return null;\n    }\n    return result;\n  }\n\n  clear() {\n    this._cache = MapWrapper.create();\n  }\n}\n\n/**\n * The compiler loads and translates the html templates of components into\n * nested ProtoViews. To decompose its functionality it uses\n * the CompilePipeline and the CompileSteps.\n */\nexport class Compiler {\n  _templateLoader:TemplateLoader;\n  _reader: DirectiveMetadataReader;\n  _parser:Parser;\n  _compilerCache:CompilerCache;\n  constructor(templateLoader:TemplateLoader, reader: DirectiveMetadataReader, parser:Parser, cache:CompilerCache) {\n    this._templateLoader = templateLoader;\n    this._reader = reader;\n    this._parser = parser;\n    this._compilerCache = cache;\n  }\n\n  createSteps(component:DirectiveMetadata):List<CompileStep> {\n    var dirs = ListWrapper.map(component.componentDirectives, (d) => this._reader.read(d));\n    return createDefaultSteps(this._parser, component, dirs);\n  }\n\n  compile(component:Type, templateRoot:Element = null):Promise<ProtoView> {\n    var templateCache = null;\n    // TODO load all components that have urls\n    // transitively via the _templateLoader and store them in templateCache\n\n    return PromiseWrapper.resolve(this.compileAllLoaded(\n      templateCache, this._reader.read(component), templateRoot)\n    );\n  }\n\n  // public so that we can compile in sync in performance tests.\n  compileAllLoaded(templateCache, component:DirectiveMetadata, templateRoot:Element = null):ProtoView {\n    var rootProtoView = this._compilerCache.get(component.type);\n    if (isPresent(rootProtoView)) {\n      return rootProtoView;\n    }\n\n    if (isBlank(templateRoot)) {\n      // TODO: read out the cache if templateRoot = null. Could contain:\n      // - templateRoot string\n      // - precompiled template\n      // - ProtoView\n      var annotation:any = component.annotation;\n      templateRoot = DOM.createTemplate(annotation.template.inline);\n    }\n\n    var pipeline = new CompilePipeline(this.createSteps(component));\n    var compileElements = pipeline.process(templateRoot);\n    rootProtoView = compileElements[0].inheritedProtoView;\n    // Save the rootProtoView before we recurse so that we are able\n    // to compile components that use themselves in their template.\n    this._compilerCache.set(component.type, rootProtoView);\n\n    for (var i=0; i<compileElements.length; i++) {\n      var ce = compileElements[i];\n      if (isPresent(ce.componentDirective)) {\n        ce.inheritedElementBinder.nestedProtoView = this.compileAllLoaded(templateCache, ce.componentDirective, null);\n      }\n    }\n\n    return rootProtoView;\n  }\n}\n","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}