{"version":3,"file":"/Users/deast/Angular/angular/modules/core/src/compiler/pipeline/element_binder_builder.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/20","element_binder_builder.js","@traceur/generated/TemplateParser/23","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"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","sourceRoot":"/Users/deast/Angular/angular/modules/core/src/compiler/pipeline/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","var $__placeholder__0 = $__export($__placeholder__1, $__placeholder__2);","function($__super) {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4, $__super);\n        }($__placeholder__5)","import {int, isPresent, isBlank, Type, BaseException, stringify} from 'facade/lang';\nimport {Element, DOM} from 'facade/dom';\nimport {ListWrapper, List, MapWrapper, StringMapWrapper} from 'facade/collection';\n\nimport {reflector} from 'reflection/reflection';\n\nimport {Parser, ProtoRecordRange} from 'change_detection/change_detection';\n\nimport {Component, Directive} from '../../annotations/annotations';\nimport {DirectiveMetadata} from '../directive_metadata';\nimport {ProtoView, ElementPropertyMemento, DirectivePropertyMemento} from '../view';\nimport {ProtoElementInjector} from '../element_injector';\nimport {ElementBinder} from '../element_binder';\n\nimport {CompileStep} from './compile_step';\nimport {CompileElement} from './compile_element';\nimport {CompileControl} from './compile_control';\n\n/**\n * Creates the ElementBinders and adds watches to the\n * ProtoRecordRange.\n *\n * Fills:\n * - CompileElement#inheritedElementBinder\n *\n * Reads:\n * - (in parent) CompileElement#inheritedElementBinder\n * - CompileElement#hasBindings\n * - CompileElement#isViewRoot\n * - CompileElement#inheritedViewRoot\n * - CompileElement#inheritedProtoElementInjector\n * - CompileElement#textNodeBindings\n * - CompileElement#propertyBindings\n * - CompileElement#eventBindings\n * - CompileElement#decoratorDirectives\n * - CompileElement#componentDirective\n * - CompileElement#templateDirective\n *\n * Note: This actually only needs the CompileElements with the flags\n * `hasBindings` and `isViewRoot`,\n * and only needs the actual HTMLElement for the ones\n * with the flag `isViewRoot`.\n */\nexport class ElementBinderBuilder extends CompileStep {\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    var elementBinder = null;\n    if (current.hasBindings) {\n      var protoView = current.inheritedProtoView;\n      elementBinder = protoView.bindElement(current.inheritedProtoElementInjector,\n        current.componentDirective, current.templateDirective);\n\n      if (isPresent(current.textNodeBindings)) {\n        this._bindTextNodes(protoView, current);\n      }\n      if (isPresent(current.propertyBindings)) {\n        this._bindElementProperties(protoView, current);\n      }\n      if (isPresent(current.eventBindings)) {\n        this._bindEvents(protoView, current);\n      }\n      this._bindDirectiveProperties(this._collectDirectives(current), current);\n    } else if (isPresent(parent)) {\n      elementBinder = parent.inheritedElementBinder;\n    }\n    current.inheritedElementBinder = elementBinder;\n  }\n\n  _bindTextNodes(protoView, compileElement) {\n    MapWrapper.forEach(compileElement.textNodeBindings, (expression, indexInParent) => {\n      protoView.bindTextNode(indexInParent, expression);\n    });\n  }\n\n  _bindElementProperties(protoView, compileElement) {\n    MapWrapper.forEach(compileElement.propertyBindings, (expression, property) => {\n      if (DOM.hasProperty(compileElement.element, property)) {\n        protoView.bindElementProperty(expression.ast, property, reflector.setter(property));\n      }\n    });\n  }\n\n  _bindEvents(protoView, compileElement) {\n    MapWrapper.forEach(compileElement.eventBindings, (expression, eventName) => {\n      protoView.bindEvent(eventName,  expression);\n    });\n  }\n\n  _collectDirectives(compileElement) {\n    var directives;\n    if (isPresent(compileElement.decoratorDirectives)) {\n      directives = ListWrapper.clone(compileElement.decoratorDirectives);\n    } else {\n      directives = [];\n    }\n    if (isPresent(compileElement.templateDirective)) {\n      ListWrapper.push(directives, compileElement.templateDirective);\n    }\n    if (isPresent(compileElement.componentDirective)) {\n      ListWrapper.push(directives, compileElement.componentDirective);\n    }\n    return directives;\n  }\n\n  _bindDirectiveProperties(typesWithAnnotations, compileElement) {\n    var protoView = compileElement.inheritedProtoView;\n    var directiveIndex = 0;\n    ListWrapper.forEach(typesWithAnnotations, (typeWithAnnotation) => {\n      var annotation = typeWithAnnotation.annotation;\n      if (isBlank(annotation.bind)) {\n        return;\n      }\n      StringMapWrapper.forEach(annotation.bind, (dirProp, elProp) => {\n        var expression = isPresent(compileElement.propertyBindings) ?\n          MapWrapper.get(compileElement.propertyBindings, elProp) :\n            null;\n        if (isBlank(expression)) {\n          throw new BaseException('No element binding found for property '+elProp\n            +' which is required by directive '+stringify(typeWithAnnotation.type));\n        }\n        var len = dirProp.length;\n        var dirBindingName = dirProp;\n        var isContentWatch = dirProp[len - 2] === '[' && dirProp[len - 1] === ']';\n        if (isContentWatch) dirBindingName = dirProp.substring(0, len - 2);\n        protoView.bindDirectiveProperty(\n          directiveIndex,\n          expression,\n          dirBindingName,\n          reflector.setter(dirBindingName),\n          isContentWatch\n        );\n      });\n      directiveIndex++;\n    });\n  }\n}\n","$traceurRuntime.superConstructor(\n          $__placeholder__0).apply(this, arguments)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}