{"version":3,"file":"/Users/deast/Angular/angular/modules/core/test/compiler/compiler_spec.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","compiler_spec.js","@traceur/generated/TemplateParser/22","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/24"],"names":[],"mappings":"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","sourceRoot":"/Users/deast/Angular/angular/modules/core/test/compiler/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","import {describe, beforeEach, it, expect, ddescribe, iit, el} from 'test_lib/test_lib';\nimport {DOM} from 'facade/dom';\nimport {List} from 'facade/collection';\n\nimport {Compiler, CompilerCache} from 'core/compiler/compiler';\nimport {ProtoView} from 'core/compiler/view';\nimport {DirectiveMetadataReader} from 'core/compiler/directive_metadata_reader';\nimport {TemplateLoader} from 'core/compiler/template_loader';\nimport {Component} from 'core/annotations/annotations';\nimport {TemplateConfig} from 'core/annotations/template_config';\nimport {CompileElement} from 'core/compiler/pipeline/compile_element';\nimport {CompileStep} from 'core/compiler/pipeline/compile_step'\nimport {CompileControl} from 'core/compiler/pipeline/compile_control';\n\nimport {Lexer, Parser} from 'change_detection/change_detection';\n\nexport function main() {\n  describe('compiler', function() {\n    var reader;\n\n    beforeEach( () => {\n      reader = new DirectiveMetadataReader();\n    });\n\n    function createCompiler(processClosure) {\n      var steps = [new MockStep(processClosure)];\n      return new TestableCompiler(reader, steps);\n    }\n\n    it('should run the steps and return the ProtoView of the root element', (done) => {\n      var rootProtoView = new ProtoView(null, null);\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = rootProtoView;\n      });\n      compiler.compile(MainComponent, el('<div></div>')).then( (protoView) => {\n        expect(protoView).toBe(rootProtoView);\n        done();\n      });\n    });\n\n    it('should use the given element', (done) => {\n      var element = el('<div></div>');\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = new ProtoView(current.element, null);\n      });\n      compiler.compile(MainComponent, element).then( (protoView) => {\n        expect(protoView.element).toBe(element);\n        done();\n      });\n    });\n\n    it('should use the inline template if no element is given explicitly', (done) => {\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = new ProtoView(current.element, null);\n      });\n      compiler.compile(MainComponent, null).then( (protoView) => {\n        expect(DOM.getInnerHTML(protoView.element)).toEqual('inline component');\n        done();\n      });\n    });\n\n    it('should load nested components', (done) => {\n      var mainEl = el('<div></div>');\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = new ProtoView(current.element, null);\n        current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n        if (current.element === mainEl) {\n          current.componentDirective = reader.read(NestedComponent);\n        }\n      });\n      compiler.compile(MainComponent, mainEl).then( (protoView) => {\n        var nestedView = protoView.elementBinders[0].nestedProtoView;\n        expect(DOM.getInnerHTML(nestedView.element)).toEqual('nested component');\n        done();\n      });\n\n    });\n\n    it('should cache components', (done) => {\n      var element = el('<div></div>');\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = new ProtoView(current.element, null);\n      });\n      var firstProtoView;\n      compiler.compile(MainComponent, element).then( (protoView) => {\n        firstProtoView = protoView;\n        return compiler.compile(MainComponent, element);\n      }).then( (protoView) => {\n        expect(firstProtoView).toBe(protoView);\n        done();\n      });\n\n    });\n\n    it('should allow recursive components', (done) => {\n      var compiler = createCompiler( (parent, current, control) => {\n        current.inheritedProtoView = new ProtoView(current.element, null);\n        current.inheritedElementBinder = current.inheritedProtoView.bindElement(null);\n        current.componentDirective = reader.read(RecursiveComponent);\n      });\n      compiler.compile(RecursiveComponent, null).then( (protoView) => {\n        expect(protoView.elementBinders[0].nestedProtoView).toBe(protoView);\n        done();\n      });\n\n    });\n\n  });\n\n}\n\n@Component({\n  template: new TemplateConfig({\n    inline: 'inline component'\n  })\n})\nclass MainComponent {}\n\n@Component({\n  template: new TemplateConfig({\n    inline: 'nested component'\n  })\n})\nclass NestedComponent {}\n\n@Component({\n  template: new TemplateConfig({\n    inline: '<div rec-comp></div>'\n  }),\n  selector: 'rec-comp'\n})\nclass RecursiveComponent {}\n\nclass TestableCompiler extends Compiler {\n  steps:List;\n  constructor(reader:DirectiveMetadataReader, steps:List<CompileStep>) {\n    super(null, reader, new Parser(new Lexer()), new CompilerCache());\n    this.steps = steps;\n  }\n  createSteps(component):List<CompileStep> {\n    return this.steps;\n  }\n}\n\nclass MockStep extends CompileStep {\n  processClosure:Function;\n  constructor(process) {\n    this.processClosure = process;\n  }\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    this.processClosure(parent, current, control);\n  }\n}\n","\n        $__export($__placeholder__0, $__placeholder__1)\n      ","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","$__placeholder__0 = $__placeholder__1","function() {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4);\n        }()","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});","function($__super) {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4, $__super);\n        }($__placeholder__5)","$traceurRuntime.superConstructor($__placeholder__0).call($__placeholder__1)"]}