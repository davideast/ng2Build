{"version":3,"file":"/Users/deast/Angular/angular/modules/core/test/compiler/pipeline/proto_view_builder_spec.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","proto_view_builder_spec.js","@traceur/generated/TemplateParser/22","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/2"],"names":[],"mappings":"AAAA,KAAK,SAAS,AAAC,mXAAuC,UAAS,SAAQ;;ACAvE,AAAI,IAAA,CAAA,YAAW,wDAAoB,CAAC;;;;;;;;;;;;;;;;;;ACW7B,SAAS,KAAG,CAAC,AAAC;AACnB,WAAO,AAAC,CAAC,kBAAiB,GAAG,SAAA,AAAC;AAC5B,aAAS,eAAa,CAAE,AAAoB;UAApB,iBAAe,6CAAE,KAAG;AAC1C,aAAO,IAAI,gBAAc,AAAC,CAAC,CAAC,GAAI,SAAO,AAAC,EAAC,SAAC,MAAK,CAAG,CAAA,OAAM,CAAG,CAAA,OAAM,CAAM;AACrE,aAAI,SAAQ,AAAC,CAAC,OAAM,QAAQ,aAAa,AAAC,CAAC,UAAS,CAAC,CAAC,CAAG;AACvD,kBAAM,WAAW,EAAI,KAAG,CAAC;UAC3B;AAAA,AACA,aAAI,SAAQ,AAAC,CAAC,OAAM,QAAQ,aAAa,AAAC,CAAC,aAAY,CAAC,CAAC,CAAG;AAC1D,kBAAM,iBAAiB,EAAI,CAAA,UAAS,oBAAoB,AAAC,CAAC,gBAAe,CAAC,CAAC;UAC7E;AAAA,AACA,gBAAM,uBAAuB,EAAI,IAAI,cAAY,AAAC,CAAC,IAAG,CAAG,KAAG,CAAG,KAAG,CAAC,CAAC;QACtE,EAAC,CAAG,IAAI,iBAAe,AAAC,EAAC,CAAC,CAAC,CAAC;MAC9B;AAEA,OAAC,AAAC,CAAC,mEAAkE,GAAG,SAAA,AAAC,CAAK;AAC5E,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,cAAa,AAAC,EAAC,QAAQ,AAAC,CAAC,EAAC,AAAC,CAAC,aAAY,CAAC,CAAC,CAAC;AACzD,aAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,mBAAmB,CAAC,KAAK,AAAC,CAAC,IAAG,CAAC,CAAC;MAClD,EAAC,CAAC;AAEF,OAAC,AAAC,CAAC,2DAA0D,GAAG,SAAA,AAAC,CAAK;AACpE,AAAI,UAAA,CAAA,eAAc,EAAI,CAAA,EAAC,AAAC,CAAC,sBAAqB,CAAC,CAAC;AAChD,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,cAAa,AAAC,EAAC,QAAQ,AAAC,CAAC,eAAc,CAAC,CAAC;AACvD,aAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,mBAAmB,QAAQ,CAAC,KAAK,AAAC,CAAC,eAAc,CAAC,CAAC;MACrE,EAAC,CAAC;AAEF,OAAC,AAAC,CAAC,2EAA0E,GAAG,SAAA,AAAC,CAAK;AACpF,AAAI,UAAA,CAAA,eAAc,EAAI,CAAA,EAAC,AAAC,CAAC,mCAAkC,CAAC,CAAC;AAC7D,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,cAAa,AAAC,EAAC,QAAQ,AAAC,CAAC,eAAc,CAAC,CAAC;AACvD,aAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,mBAAmB,QAAQ,CAAC,KAAK,AAAC,CAAC,eAAc,CAAC,CAAC;AACnE,aAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,mBAAmB,QAAQ,CAAC,KAAK,AAAC,CAAC,eAAc,CAAC,CAAC;MACrE,EAAC,CAAC;AAEF,OAAC,AAAC,CAAC,gEAA+D,GAAG,SAAA,AAAC,CAAK;AACzE,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,EAAC,AAAC,CAAC,2DAA0D,CAAC,CAAC;AAC7E,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,cAAa,AAAC,EAAC,QAAQ,AAAC,CAAC,OAAM,CAAC,CAAC;AAC/C,aAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,uBAAuB,gBAAgB,CAAC,KAAK,AAAC,CAAC,OAAM,CAAE,CAAA,CAAC,mBAAmB,CAAC,CAAC;MAC/F,EAAC,CAAC;AAEF,OAAC,AAAC,CAAC,+CAA8C,GAAG,SAAA,AAAC,CAAK;AACxD,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,EAAC,AAAC,CAAC,uEAAsE,CAAC,CAAC;AACzF,AAAI,UAAA,CAAA,OAAM,EAAI,CAAA,cAAa,AAAC,CAAC;AAC3B,eAAK,CAAG,OAAK;AACb,eAAK,CAAG,OAAK;AAAA,QACf,CAAC,QAAQ,AAAC,CAAC,OAAM,CAAC,CAAC;AACnB,AAAI,UAAA,CAAA,GAAE,EAAI,CAAA,OAAM,CAAE,CAAA,CAAC,uBAAuB,gBAAgB,CAAC;AAC3D,aAAK,AAAC,CAAC,GAAE,iBAAiB,CAAC,QAAQ,AAAC,CAAC,UAAS,oBAAoB,AAAC,CAAC;AAClE,eAAK,CAAG,OAAK;AACb,eAAK,CAAG,OAAK;AAAA,QACf,CAAC,CAAC,CAAC;MACL,EAAC,CAAC;AAEF,aAAO,AAAC,CAAC,QAAO,GAAG,SAAA,AAAC;AAElB,SAAC,AAAC,CAAC,yEAAwE,GAAG,SAAA,AAAC;AAC7E,AAAI,YAAA,CAAA,OAAM,EAAI,CAAA,EAAC,AAAC,CAAC,2EAA0E,CAAC,CAAC;AAC7F,eAAK,AAAC,EAAE,SAAA,AAAC,CAAK;AACZ,yBAAa,AAAC,EAAC,QAAQ,AAAC,CAAC,OAAM,CAAC,CAAC;UACnC,EAAC,aAAa,AAAC,CAAC,6CAA4C,CAAC,CAAC;QAChE,EAAC,CAAC;MAEJ,EAAC,CAAC;IAEJ,EAAC,CAAC;EACJ;ACzEQ,UAAQ,AAAC,cAAqC,CAAA;ACDtD,OAAO;AACD,UAAM,GCDZ,SAAS,CAAA;ACAT,eAAoB,EAAA,SAAkB,CAAC;AAAvC,iBAAoB,EAAA,WAAkB,CAAC;AAAvC,SAAoB,EAAA,GAAkB,CAAC;AAAvC,aAAoB,EAAA,OAAkB,CAAC;AAAvC,UAAoB,EAAA,IAAkB,CAAC;AAAvC,gBAAoB,EAAA,UAAkB,CAAC;AAAvC,SAAoB,EAAA,GAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,gBAAoB,EAAA,UAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,oBAAoB,EAAA,cAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,uBAAoB,EAAA,iBAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,sBAAoB,EAAA,gBAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,qBAAoB,EAAA,eAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,kBAAoB,EAAA,YAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,qBAAoB,EAAA,eAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,UAAoB,EAAA,IAAkB,CAAC;IDE/B,CAFR,UAAS,CAAA,CAAG;ACAZ,iBAAoB,EAAA,WAAkB,CAAC;IDE/B,CDDuB;AACzB,UAAM;AGFZ,iBCAA,SAAS,QAAO;AACN,AAAI,UAAA,WN2Ed,SAAM,SAAO,CAEC,OAAM,CAAG;AACnB,aAAG,eAAe,EAAI,QAAM,CAAC;QM9EiB,AN+EhD,CM/EiD;AACzC,aAAO,CAAA,CAAC,eAAc,YAAY,CAAC,AAAC,YN+E5C,OAAM,CAAN,UAAQ,MAAK,AAAe,CAAG,CAAA,OAAM,AAAe,CAAG,CAAA,OAAM,AAAe,CAAG;AAC7E,eAAG,eAAe,AAAC,CAAC,MAAK,CAAG,QAAM,CAAG,QAAM,CAAC,CAAC;UAC/C,MMhFgE,SAAO,CAAC,CAAC;MACnE,AAAC,CNwEc,WAAU,CMxEN,CDJS,CAAA;AEApC,WAAK,eAAe,AAAC,0CACb,EAAC,GAAE,CAAG,UAAQ,AAAC,CAAE;AAAC,kBPgFT,cAAa,IAAW,cAAa,IAAW,cAAa,GOhF7B;QAAC,CAAC,CAAC,CAAC;ILCtB;EAC3B,CAAA;AJDI,CAAC,CAAC;AEkFV","sourceRoot":"/Users/deast/Angular/angular/modules/core/test/compiler/pipeline/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","import {describe, beforeEach, it, expect, iit, ddescribe, el} from 'test_lib/test_lib';\nimport {isPresent} from 'facade/lang';\nimport {ElementBinder} from 'core/compiler/element_binder';\nimport {ProtoViewBuilder} from 'core/compiler/pipeline/proto_view_builder';\nimport {CompilePipeline} from 'core/compiler/pipeline/compile_pipeline';\nimport {CompileElement} from 'core/compiler/pipeline/compile_element';\nimport {CompileStep} from 'core/compiler/pipeline/compile_step'\nimport {CompileControl} from 'core/compiler/pipeline/compile_control';\nimport {DOM} from 'facade/dom';\nimport {MapWrapper} from 'facade/collection';\n\nexport function main() {\n  describe('ProtoViewBuilder', () => {\n    function createPipeline(variableBindings=null) {\n      return new CompilePipeline([new MockStep((parent, current, control) => {\n        if (isPresent(current.element.getAttribute('viewroot'))) {\n          current.isViewRoot = true;\n        }\n        if (isPresent(current.element.getAttribute('var-binding'))) {\n          current.variableBindings = MapWrapper.createFromStringMap(variableBindings);\n        }\n        current.inheritedElementBinder = new ElementBinder(null, null, null);\n      }), new ProtoViewBuilder()]);\n    }\n\n    it('should not create a ProtoView when the isViewRoot flag is not set', () => {\n      var results = createPipeline().process(el('<div></div>'));\n      expect(results[0].inheritedProtoView).toBe(null);\n    });\n\n    it('should create a ProtoView when the isViewRoot flag is set', () => {\n      var viewRootElement = el('<div viewroot></div>');\n      var results = createPipeline().process(viewRootElement);\n      expect(results[0].inheritedProtoView.element).toBe(viewRootElement);\n    });\n\n    it('should inherit the ProtoView down to children that have no isViewRoot set', () => {\n      var viewRootElement = el('<div viewroot><span></span></div>');\n      var results = createPipeline().process(viewRootElement);\n      expect(results[0].inheritedProtoView.element).toBe(viewRootElement);\n      expect(results[1].inheritedProtoView.element).toBe(viewRootElement);\n    });\n\n    it('should save ProtoView into the elementBinder of parent element', () => {\n      var element = el('<div viewroot><template><a viewroot></a></template></div>');\n      var results = createPipeline().process(element);\n      expect(results[1].inheritedElementBinder.nestedProtoView).toBe(results[2].inheritedProtoView);\n    });\n\n    it('should bind variables to the nested ProtoView', () => {\n      var element = el('<div viewroot><template var-binding><a viewroot></a></template></div>');\n      var results = createPipeline({\n        'var1': 'map1',\n        'var2': 'map2'\n      }).process(element);\n      var npv = results[1].inheritedElementBinder.nestedProtoView;\n      expect(npv.variableBindings).toEqual(MapWrapper.createFromStringMap({\n        'var1': 'map1',\n        'var2': 'map2'\n      }));\n    });\n\n    describe('errors', () => {\n\n      it('should not allow multiple nested ProtoViews for the same parent element', () => {\n        var element = el('<div viewroot><template><a viewroot></a><a viewroot></a></template></div>');\n        expect( () => {\n          createPipeline().process(element);\n        }).toThrowError('Only one nested view per element is allowed');\n      });\n\n    });\n\n  });\n}\n\nclass MockStep extends CompileStep {\n  processClosure:Function;\n  constructor(process) {\n    this.processClosure = process;\n  }\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    this.processClosure(parent, current, control);\n  }\n}","\n        $__export($__placeholder__0, $__placeholder__1)\n      ","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","$__placeholder__0 = $__placeholder__1","function($__super) {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4, $__super);\n        }($__placeholder__5)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}