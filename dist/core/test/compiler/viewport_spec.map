{"version":3,"file":"/Users/deast/Angular/angular/modules/core/test/compiler/viewport_spec.js","sources":["@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/12","viewport_spec.js","@traceur/generated/TemplateParser/22","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/8","@traceur/generated/TemplateParser/14"],"names":[],"mappings":"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","sourceRoot":"/Users/deast/Angular/angular/modules/core/test/compiler/","sourcesContent":["System.register($__placeholder__0, $__placeholder__1, function($__export) {\n          $__placeholder__2\n        });","var __moduleName = $__placeholder__0;","import {describe, xit, it, expect, beforeEach, ddescribe, iit, el} from 'test_lib/test_lib';\nimport {View, ProtoView} from 'core/compiler/view';\nimport {ViewPort} from 'core/compiler/viewport';\nimport {DOM} from 'facade/dom';\nimport {ListWrapper, MapWrapper} from 'facade/collection';\nimport {Injector} from 'di/di';\nimport {ProtoElementInjector, ElementInjector} from 'core/compiler/element_injector';\nimport {ProtoRecordRange, Lexer, Parser} from 'change_detection/change_detection';\n\nfunction createView(nodes) {\n  var view = new View(null, nodes, new ProtoRecordRange(), MapWrapper.create());\n  view.init([], [], [], [], [], [], []);\n  return view;\n}\n\nexport function main() {\n  describe('viewport', () => {\n    var viewPort, parentView, protoView, dom, customViewWithOneNode,\n        customViewWithTwoNodes, elementInjector;\n\n    beforeEach(() => {\n      dom = el(`<div><stuff></stuff><div insert-after-me></div><stuff></stuff></div>`);\n      var insertionElement = dom.childNodes[1];\n      parentView = createView([dom.childNodes[0]]);\n      protoView = new ProtoView(el('<div>hi</div>'), new ProtoRecordRange());\n      elementInjector = new ElementInjector(null, null, null);\n      viewPort = new ViewPort(parentView, insertionElement, protoView, elementInjector);\n      customViewWithOneNode = createView([el('<div>single</div>')]);\n      customViewWithTwoNodes = createView([el('<div>one</div>'), el('<div>two</div>')]);\n    });\n\n    describe('when dehydrated', () => {\n      it('should throw if create is called', () => {\n        expect(() => viewPort.create()).toThrowError();\n      });\n    });\n\n    describe('when hydrated', () => {\n      function textInViewPort() {\n        var out = '';\n        // skipping starting filler, insert-me and final filler.\n        for (var i = 2; i < dom.childNodes.length - 1; i++) {\n          if (i != 2) out += ' ';\n          out += DOM.getInnerHTML(dom.childNodes[i]);\n        }\n        return out;\n      }\n\n      beforeEach(() => {\n        viewPort.hydrate(new Injector([]), null);\n        var fillerView = createView([el('<filler>filler</filler>')]);\n        viewPort.insert(fillerView);\n      });\n\n      it('should create new views from protoView', () => {\n        viewPort.create();\n        expect(textInViewPort()).toEqual('filler hi');\n        expect(viewPort.length).toBe(2);\n      });\n\n      it('should create new views from protoView at index', () => {\n        viewPort.create(0);\n        expect(textInViewPort()).toEqual('hi filler');\n        expect(viewPort.length).toBe(2);\n      });\n\n      it('should insert new views at the end by default', () => {\n        viewPort.insert(customViewWithOneNode);\n        expect(textInViewPort()).toEqual('filler single');\n        expect(viewPort.get(1)).toBe(customViewWithOneNode);\n        expect(viewPort.length).toBe(2);\n      });\n\n      it('should insert new views at the given index', () => {\n        viewPort.insert(customViewWithOneNode, 0);\n        expect(textInViewPort()).toEqual('single filler');\n        expect(viewPort.get(0)).toBe(customViewWithOneNode);\n        expect(viewPort.length).toBe(2);\n      });\n\n      it('should remove the last view by default', () => {\n        viewPort.insert(customViewWithOneNode);\n\n        var removedView = viewPort.remove();\n\n        expect(textInViewPort()).toEqual('filler');\n        expect(removedView).toBe(customViewWithOneNode);\n        expect(viewPort.length).toBe(1);\n      });\n\n      it('should remove the view at a given index', () => {\n        viewPort.insert(customViewWithOneNode);\n        viewPort.insert(customViewWithTwoNodes);\n\n        var removedView = viewPort.remove(1);\n        expect(removedView).toBe(customViewWithOneNode);\n        expect(textInViewPort()).toEqual('filler one two');\n        expect(viewPort.get(1)).toBe(customViewWithTwoNodes);\n        expect(viewPort.length).toBe(2);\n      });\n\n      it('should support adding/removing views with more than one node', () => {\n        viewPort.insert(customViewWithTwoNodes);\n        viewPort.insert(customViewWithOneNode);\n\n        expect(textInViewPort()).toEqual('filler one two single');\n\n        viewPort.remove(1);\n        expect(textInViewPort()).toEqual('filler single');\n      });\n    });\n\n    describe('should update injectors and parent views.', () => {\n      var fancyView;\n      beforeEach(() => {\n        var parser = new Parser(new Lexer());\n        viewPort.hydrate(new Injector([]), null);\n\n        var pv = new ProtoView(el('<div class=\"ng-binding\">{{}}</div>'),\n          new ProtoRecordRange());\n        pv.bindElement(new ProtoElementInjector(null, 1, [SomeDirective]));\n        pv.bindTextNode(0, parser.parseBinding('foo', null));\n        fancyView = pv.instantiate(null);\n      });\n\n      it('hydrating should update rootElementInjectors and parent RR', () => {\n        viewPort.insert(fancyView);\n        ListWrapper.forEach(fancyView.rootElementInjectors, (inj) =>\n            expect(inj.parent).toBe(elementInjector));\n        expect(parentView.recordRange.findFirstEnabledRecord()).not.toBe(null);\n      });\n\n      it('dehydrating should update rootElementInjectors and parent RR', () => {\n        viewPort.insert(fancyView);\n        viewPort.remove();\n        ListWrapper.forEach(fancyView.rootElementInjectors, (inj) =>\n            expect(inj.parent).toBe(null));\n        expect(parentView.recordRange.findFirstEnabledRecord()).toBe(null);\n        expect(viewPort.length).toBe(0);\n      });\n    });\n  });\n}\n\nclass SomeDirective {\n  prop;\n  constructor() {\n    this.prop = 'foo';\n  }\n}\n","\n        $__export($__placeholder__0, $__placeholder__1)\n      ","return {\n      setters: $__placeholder__0,\n      execute: $__placeholder__1\n    }","function(m) {\n          $__placeholder__0\n        }","$__placeholder__0 = m.$__placeholder__1;","$__placeholder__0 = $__placeholder__1","function() {\n          var $__placeholder__0 = $__placeholder__1;\n          return ($traceurRuntime.createClass)($__placeholder__2, $__placeholder__3,\n                                               $__placeholder__4);\n        }()"]}